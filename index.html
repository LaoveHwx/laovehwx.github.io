<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»™æˆ‘çš„æœ€çˆ± hwx</title>

    <!-- å­—ä½“å›¾æ ‡ & Supabase -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        /* ===== å…¬å…±æ ·å¼ ===== */
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
            color:#8a2b53;
            min-height:100vh;
            background-image:url('æˆ‘ä»¬.jpg');
            background-position:5% center;
            background-size:cover;
            background-repeat:no-repeat;
            background-attachment:fixed;
            background-color:rgba(255,235,238,.9);
            display:flex;
            justify-content:center;
            align-items:flex-start;
            padding:20px;
            overflow-x: hidden;
        }
        #hearts{position:fixed;width:100%;height:100%;top:0;left:0;z-index:0;pointer-events:none}
        .heart{position:absolute;font-size:20px;color:#ff4d6d;opacity:.7;animation:fall linear forwards;pointer-events: none;z-index: 0;}
        @keyframes fall{to{transform:translateY(100vh) rotate(30deg);}}

        /* ===== å·¦ä¾§å¯¼èˆª ===== */
        .sidebar{
            position:fixed;left:0;top:0;height:100vh;width:250px;
            background:linear-gradient(to bottom,#ff9a9e,#fad0c4);
            padding:20px 0;z-index:10;box-shadow:2px 0 10px rgba(0,0,0,.1);
            transition:all .3s ease;
        }
        .logo{color:#fff;text-align:center;font-size:1.5rem;font-weight:bold;margin-bottom:30px;text-shadow:1px 1px 3px rgba(0,0,0,.2)}
        .nav-links{list-style:none;padding:0}
        .nav-item{display:flex;align-items:center;padding:15px 25px;margin:5px 0;color:#fff;cursor:pointer;transition:.3s;border-left:4px solid transparent}
        .nav-item:hover{background:rgba(255,255,255,.1)}
        .nav-item.active{background:rgba(255,255,255,.2);border-left:4px solid #fff}
        .nav-item i{margin-right:15px;font-size:1.2rem}

        /* ===== é¡µé¢å†…å®¹ ===== */
        .page-content{margin-left:250px;width:calc(100% - 250px);min-height:100vh;transition:all .3s ease}
        .page{display:none;padding:20px}
        .page.active{display:block}

        /* ===== é¦–é¡µå†…å®¹ ===== */
        .content{
            position:relative;z-index:1;display:flex;flex-direction:column;justify-content:center;
            align-items:center;text-align:center;padding:30px;
            background:rgba(255,255,255,.12);border-radius:20px;max-width:90%;width:600px;margin:40px 0;
            box-shadow:0 10px 30px rgba(0,0,0,.15);backdrop-filter:blur(5px);border:1px solid rgba(255,255,255,.25)
        }
        h1{font-size:2.5rem;margin-bottom:20px;color:#d81b60;text-shadow:2px 2px 4px rgba(0,0,0,.1)}
        .message{width:100%;padding:25px;border-radius:15px;margin-bottom:30px;
            line-height:1.6;font-size:1.1rem;background:rgba(255,255,255,.5);text-align:left}
        .message p{margin-bottom:15px}

        /* ===== è®¡æ—¶å™¨ ===== */
        .love-timer{text-align:center;margin-bottom:30px;padding:20px;background:rgba(255,255,255,.9);
            border-radius:15px;box-shadow:0 5px 20px rgba(216,27,96,.2);border:2px solid #ff80ab;width:100%}
        .timer-title{font-size:1.2rem;color:#d81b60;margin-bottom:10px;font-weight:bold}
        .timer-display{font-size:1.5rem;font-weight:bold;color:#e91e63;margin:10px 0;
            display:flex;justify-content:center;flex-wrap:wrap;gap:5px}
        .timer-display span{background:linear-gradient(45deg,#f48fb1,#f06292);padding:5px 10px;border-radius:8px;
            color:white;min-width:40px;display:inline-block;text-align:center;box-shadow:0 2px 5px rgba(0,0,0,.1)}
        .timer-start{font-size:.9rem;color:#888;font-style:italic;margin-top:10px}

        /* ===== éŸ³ä¹æ’­æ”¾å™¨ ===== */
        .music-player{width:100%;margin-top:20px;background:linear-gradient(to right,rgba(233,30,99,.35),rgba(255,64,129,.35));
            padding:15px 20px;border-radius:50px;display:flex;align-items:center;justify-content:space-between;
            color:white;box-shadow:0 4px 15px rgba(233,30,99,.3);backdrop-filter:blur(5px);border:1px solid rgba(255,255,255,.2)}
        .play-btn{background:none;border:none;color:white;font-size:1.5rem;cursor:pointer;margin-right:15px;
            width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:.3s}
        .play-btn:hover{background:rgba(255,255,255,.2)}
        .progress-container{flex-grow:1;margin:0 15px;height:4px;background:rgba(255,255,255,.3);border-radius:2px;cursor:pointer;position:relative}
        .progress{height:100%;background:white;border-radius:2px;width:0}
        .time{font-size:.8rem;min-width:40px}

        /* ===== çƒŸèŠ±æŒ‰é’® ===== */
        #fireworksBtn{position:fixed;bottom:20px;right:20px;z-index:100;
            background:linear-gradient(135deg,#6e8efb,#a777e3,#ffd700,#ff8c00);
            color:white;border:none;padding:12px 20px;border-radius:30px;
            cursor:pointer;font-weight:bold;box-shadow:0 4px 15px rgba(0,0,0,.2);transition:.3s}
        #fireworksBtn:hover{transform:translateY(-3px);box-shadow:0 7px 20px rgba(0,0,0,.3)}

        /* ===== çƒŸèŠ± & æ–‡å­— ===== */
        #fireworks-container{position:fixed;top:0;left:0;width:100%;height:100%;
            pointer-events:none;z-index:99;display:none;overflow:hidden}
        #qixi-text{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);
            font-weight:bold;color:transparent;background:linear-gradient(45deg,#6e8efb,#a777e3,#ffd700,#ff8c00);
            -webkit-background-clip:text;background-clip:text;z-index:100;opacity:0;
            pointer-events:none;text-shadow:0 0 10px rgba(255,255,255,.5);
            transition:all 2s ease;white-space:nowrap;font-size:4rem;text-align:center;width:100%;padding:0 20px}

        /* ===== å¼€å¿ƒæ”¶é›†ç«™å’Œåæƒ…ç»ªåƒåœ¾æ¡¶ ===== */
        .entries-container {
            max-width:800px;margin:0 auto;padding:20px;
            background:rgba(255,255,255,.9);border-radius:20px;
            box-shadow:0 10px 30px rgba(0,0,0,.1)
        }
        .entries-container h2 {color:#d81b60;margin-bottom:15px;}
        .entries-container p {margin-bottom:20px;color:#666;}
        .entry-textarea {
            width:100%;height:120px;padding:15px;
            border:2px solid #ffd166;border-radius:15px;
            resize:none;margin-bottom:15px;font-family:inherit;
        }
        .save-btn {
            background:linear-gradient(to right,#ff9a9e,#fad0c4);
            color:#fff;border:none;padding:12px 25px;
            border-radius:30px;cursor:pointer;font-weight:bold;
        }
        .trash-textarea {border-color:#b0b0b0;}
        .trash-btn {background:#616161;}
        .entries-list {max-height:400px;overflow-y:auto;margin-top:20px;}
        .entry-item {
            background:rgba(255,255,255,.7);border-radius:10px;
            padding:15px;margin-bottom:15px;border-left:4px solid #ff9a9e;
        }
        .trash-item {border-left-color:#9e9e9e;}
        .entry-date {font-size:.8rem;color:#888;margin-bottom:8px;}
        .entry-meta {font-size:.7rem;color:#aaa;margin-top:4px;}

        /* ===== å“åº”å¼ ===== */
        @media (max-width:1100px){
            .content{width:90%;max-width:90%;padding:20px}
            .message{padding:15px;font-size:1rem}
            h1{font-size:2rem}
        }
        @media(max-width:900px){
            .sidebar{width:70px}
            .page-content{margin-left:70px;width:calc(100% - 70px)}
            .nav-item span{display:none}
            .logo{font-size:1rem}
        }
        @media(max-width:768px){
            h1{font-size:1.8rem}
            #qixi-text{font-size:3rem}
            .timer-display{font-size:1.2rem}
            .timer-display span{min-width:30px;padding:3px 8px}
            .music-player{flex-wrap:wrap;padding:10px 15px}
            .progress-container{order:3;width:100%;margin:10px 0 0 0}
        }
        @media(max-width:600px){
            body{padding:10px}
            .sidebar{width:100%;height:60px;bottom:0;top:auto;display:flex;justify-content:space-around;padding:0;
                background:linear-gradient(to right,#ff9a9e,#fad0c4)}
            .logo{display:none}
            .nav-links{display:flex;width:100%;justify-content:space-around}
            .nav-item{flex-direction:column;padding:10px 5px;margin:0;border-left:none;border-top:4px solid transparent;font-size:.8rem}
            .nav-item.active{border-left:none;border-top:4px solid #fff}
            .nav-item i{margin-right:0;margin-bottom:5px;font-size:1rem}
            .page-content{margin-left:0;width:100%;padding-bottom:70px}
            #qixi-text{font-size:2.5rem}
            .content{margin:20px 0;padding:15px}
            .love-timer{padding:15px}
            .message{padding:10px;font-size:.95rem}
            #fireworksBtn{bottom:70px;right:10px;padding:10px 15px;font-size:.9rem}
        }
        @media(max-width:400px){
            h1{font-size:1.6rem}
            .timer-display{font-size:1rem;gap:3px}
            .timer-display span{min-width:25px;padding:2px 5px}
            #qixi-text{font-size:2rem}
        }
    </style>
</head>
<body>
    <!-- çˆ±å¿ƒèƒŒæ™¯ -->
    <div id="hearts"></div>

    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <nav class="sidebar">
        <div class="logo">çˆ±çš„å°å±‹</div>
        <ul class="nav-links">
            <li class="nav-item active" data-page="home">
                <i class="fas fa-home"></i><span>é¦–é¡µ</span>
            </li>
            <li class="nav-item" data-page="happy">
                <i class="fas fa-smile"></i><span>å¼€å¿ƒæ”¶é›†ç«™</span>
            </li>
            <li class="nav-item" data-page="trash">
                <i class="fas fa-trash-alt"></i><span>åæƒ…ç»ªåƒåœ¾æ¡¶</span>
            </li>
        </ul>
    </nav>

    <!-- é¡µé¢å†…å®¹åŒºåŸŸ -->
    <div class="page-content">
        <!-- é¦–é¡µ -->
        <div id="home-page" class="page active">
            <div class="content">
                <!-- çˆ±æƒ…è®¡æ—¶å™¨ -->
                <div class="love-timer">
                    <div class="timer-title">æˆ‘ä»¬ç›¸çˆ±å·²ç»</div>
                    <div class="timer-display" id="loveTimer">
                        <span id="years">0</span>å¹´
                        <span id="months">0</span>æœˆ
                        <span id="days">0</span>å¤©
                        <span id="hours">0</span>æ—¶
                        <span id="minutes">0</span>åˆ†
                        <span id="seconds">0</span>ç§’
                    </div>
                    
                    <div class="timer-start">ç›´åˆ°ä»Šå¤©ä¹Ÿä¾ç„¶çˆ±ä½ ï¼</div>
                    <!-- æ–°å¢å€’è®¡æ—¶åŒºåŸŸ -->
    <div class="timer-start" id="countDownArea">
        <div id="hundredDay"></div>
        <div id="yearDay"></div>
        <div id="day328"></div>
    </div>
</div>
                </div>

                <!-- éŸ³ä¹æ’­æ”¾å™¨ -->
                <div class="music-player">
                    <div class="player-controls">
                        <button class="play-btn" id="playBtn"><i class="fas fa-play"></i></button>
                        <div class="song-info"><div class="song-title">æˆ‘ä»¬</div><div class="artist">è‡´æˆ‘ä»¬</div></div>
                    </div>
                    <div class="progress-container" id="progressContainer"><div class="progress" id="progress"></div></div>
                    <div class="time" id="currentTime">0:00</div>
                    <div class="volume-container">
                        <button class="volume-btn" id="volumeBtn"><i class="fas fa-volume-up"></i></button>
                        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.01" value="0.7">
                    </div>
                </div>

                <!-- æ ‡é¢˜ -->
                <h1>ç»™æˆ‘æœ€äº²çˆ±çš„äºº</h1>

                <!-- ä¿¡ä»¶ -->
                <div class="message">
                    <p>äº²çˆ±çš„èƒ¡å©‰æ¬£ï¼Œå¾ˆå¼€å¿ƒé‡è§ä½ ï¼Œè¿˜è·Ÿä½ åšäº†æƒ…ä¾£ï¼Œè§‰å¾—è‡ªå·±è¶…çº§å¹¸è¿çš„ï¼ï¼ï¼</p>
                    <p>ç»™ä½ åšçš„è¿™ä¸ªå°ç½‘ç«™åªè¦è”ç½‘éšæ—¶å¯ä»¥è¿›æ¥ï¼Œç»™ä½ ä¸€ä¸ªä¸ä¸€æ ·çš„æƒ…äººèŠ‚</p>
                    <p>é¦–å…ˆï¼Œæˆ‘è¦è¡¨è¾¾å¯¹ä½ çš„æ„Ÿè§‰ï¼Œå®ƒå°±åƒæ˜¯çœ‹è§ä¸€åªå¾ˆå–œæ¬¢çš„å°çŒ«ï¼Œå¹²ä»€ä¹ˆäº‹æƒ…éƒ½å¾ˆå¯çˆ±ï¼Œä¸å¼€å¿ƒäº†ä¹Ÿä¼šè§‰å¾—"å¥¹åªæ˜¯ä¸€åªå°å’ªè€Œå·²å•¦"ã€‚æƒ³ç»™ä½ åƒå¥½åƒçš„ï¼Œçœ‹ä¸å¾—ä½ ä¸å¼€å¿ƒçœ‹ä¸å¾—ä½ ä¸èˆ’æœï¼Œå¾ˆæƒ³ç…§é¡¾ä½ è¿™åªå°çŒ«ã€‚å°å’ªè¿˜å°ï¼Œå¾ˆå¤šäº‹æƒ…éƒ½ä¸ä¼šï¼Œæ‰€ä»¥æˆ‘ä¼šå¥½å¥½çˆ±ä½ ã€‚</p>
                    <p>æœ‰æ—¶å€™å°±æ˜¯æˆ‘çˆ±çš„ä¸€ä¸ªäººï¼Œä¸€ä¸ªå®Œå®Œæ•´æ•´çš„ä½ ã€‚å¥½çš„åçš„ï¼Œé‚£äº›éƒ½æ˜¯ç»„æˆä½ çš„éƒ¨åˆ†ï¼Œåªè¦æ˜¯ä½ ï¼Œæˆ‘éƒ½æ„¿æ„æ¥è¿‘ä½ ï¼ŒæŠ±ä½ä½ ã€‚</p>
                    <p>æœ€è¿‘æˆ‘æ‰å­¦ä¼šï¼Œæˆ‘è¿™ç§è¯´çš„åšçš„çŸ¥è¡Œä¸åˆä¸€å¯¹ä½ æ¥è¯´éå¸¸åœ°æ— è¯­ï¼Œæ‰€ä»¥å€Ÿæ­¤æœºä¼šï¼Œæˆ‘æƒ³è·Ÿä½ è¯´ï¼Œæˆ‘æ˜ç™½äº†çˆ±æ˜¯ä½ åœ¨ä¸“æ³¨åšäº‹æƒ…çš„æ—¶å€™é€’ä¸Šçš„ä¸€æ¯æ¸©æ°´ï¼Œæ˜¯ä½ ç´¯çš„æ—¶å€™ï¼Œä¸€ä¸ªä¸å†å¤šå˜´çš„å®‰é™çš„æ‹¥æŠ±ï¼Œæ˜¯ä½ æƒ³ä¸€ä¸ªäººå¾…ä¼šå„¿çš„æ—¶å€™ï¼Œæˆ‘çˆ½å¿«è¯´"å¥½"çš„ç¬é—´</p>
                    <p>è¿™æ˜¯æˆ‘æ­£åœ¨å­¦ä¹ ï¼Œå¹¶ä¸”ä¼šä¸€ç›´å­¦ä¹ çš„è‡ªæˆ‘æˆé•¿è¯¾é¢˜â€”â€”å­¦ä¼šçˆ±ï¼Œæ­£ç¡®çš„çˆ±ï¼Œè®©ä½ å’Œæˆ‘å¾…åœ¨å¯ä»¥è½»è½»æ¾æ¾çš„ï¼Œå¼€å¿ƒå¿«ä¹çš„ï¼Œæ— æ‹˜æ— æŸçš„</p>
                    <p>çˆ±åº”è¯¥æ˜¯ï¼Œä½ è‡ªç”±çš„ï¼Œæˆ‘æ—è§‚çš„ï¼Œéœ€è¦çš„æ—¶å€™å¯ä»¥å¸®åŠ©ä½ çš„ï¼Œå½¼æ­¤éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚ä¸ç»™ä½ å¤ªå¤šå‹åŠ›ã€‚å…¶å®æœ‰æ—¶å€™æˆ‘åº”è¯¥çŸ¥é“ï¼Œä½ ä¹Ÿè¿˜æ˜¯å°å’ªï¼Œä¸€ä¸ªäººé•¿è¿™ä¹ˆå¤§ï¼Œä¹Ÿæ²¡äººæ•™ä½ æ€ä¹ˆçˆ±ï¼Œæˆ‘ä¸èƒ½è¦æ±‚ä½ å¤ªå¤šäº†ã€‚ä½ ç»™æˆ‘çš„å·²ç»æ˜¯ä½ èƒ½ç»™çš„æœ€å¥½çš„äº†ï¼Œæˆ‘çæƒœï¼Œæˆ‘åº†å¹¸ï¼Œæˆ‘å¹¸ç¦ï¼Œéå¸¸è°¢è°¢ä½ çˆ±æˆ‘ï¼ï¼</p>
                    <p>äººå˜›ï¼Œçˆ±ä¸€ä¸ªäººè‚¯å®šä¼šå¯¹å¥¹æœ‰æ‰€æœŸå¾…ï¼Œæ‰€ä»¥çˆ±ä½ çš„å¿ƒè·¯ä¹Ÿå¾ˆæ›²æŠ˜ï¼Œå†…è€—åˆè‡ªæ„ˆï¼Œæƒ³å¼€äº†åˆçº ç»“çš„ï¼Œæˆ‘å‘Šè¯‰è‡ªå·±åšæŒï¼Œå› ä¸ºçœŸçš„ç‰¹åˆ«çˆ±ä½ ï¼Œéœ€è¦ä¹‰æ— åé¡¾ï¼Œè¦å‹‡æ•¢ã€‚ä½†æ˜¯æ²¡å…³ç³»ï¼Œå¥½åœ¨ä½ ä¹Ÿåœ¨æ¥è¿‘æˆ‘ï¼Œæ„¿æ„çˆ±æˆ‘ï¼Œæ„¿æ„ä¸ºæˆ‘è°ƒæ•´å’Œæ”¹å˜ã€‚æˆ‘çŸ¥é“ä½ å·²ç»åšåˆ°ä½ èƒ½åšçš„æœ€å¥½ï¼Œæ‰€ä»¥æˆ‘è¦çæƒœã€‚</p>
                    <p>ä¹‹å‰æˆ‘ä»¬ä¸å¼€å¿ƒé‚£äº›ï¼Œå›æƒ³èµ·æ¥å¾ˆæ˜¯å¾ˆå¿ƒç–¼ï¼Œè¯·ä½ ç›¸ä¿¡æˆ‘ä¼šç”¨åé¢çš„æ—¥å­è®©ä½ é‡æ–°è®¤è¯†æˆ‘è¿™ä¸ªåˆæ–°ä¹Ÿæ—§çš„é»å®‰é”ã€‚</p>
                    <p>ç›´åˆ°ä»Šå¤©ï¼Œæˆ‘è¿˜æ˜¯å¾ˆçˆ±ä½ ï¼Œä»…ä»…å‘ŠçŸ¥ä½ çš„é‚£ç§æˆ‘çˆ±ä½ ã€‚é»å®‰é”é™ªä½ æˆé•¿ï¼Œé™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆï¼Œæˆ‘å¸Œæœ›æˆ‘ä»¬æ—¶é—´å¯ä»¥é•¿ä¸€äº›ï¼Œå†é•¿ä¸€äº›ï¼Œå†é•¿ä¸€æŠ¹å¤šâ€¦â€¦</p>
                    <p>è‡³æ­¤ï¼Œç¥æˆ‘ä»¬ç¬¬ä¸‰æ¬¡ä¸ƒå¤•å¿«ä¹ï¼Œæˆ‘çš„æ¢¦å¯ä»¥æ±‚çš„çˆ±äººï¼Œçæƒœè‹¥å®çš„ï¼Œèƒ¡å©‰æ¬£ã€‚</p>
                    <p>â€”â€”çˆ±ä½ çš„é»å®‰é”</p>
                </div>

                <div class="footer"><p>æ°¸è¿œçˆ±ä½ çš„é»å®‰é” â¤ï¸</p></div>
            </div>
        </div>

        <!-- å¼€å¿ƒæ”¶é›†ç«™ -->
        <div id="happy-page" class="page">
            <div class="entries-container">
                <h2>å¼€å¿ƒæ”¶é›†ç«™</h2>
                <p>è®°å½•ç”Ÿæ´»ä¸­çš„æ¯ä¸€ä¸ªå¿«ä¹ç¬é—´</p>
                <div class="happy-input">
                    <textarea id="happy-text" class="entry-textarea" placeholder="ä»Šå¤©æœ‰ä»€ä¹ˆå¼€å¿ƒçš„äº‹å‘€ï¼Ÿ"></textarea>
                    <button id="save-happy" class="save-btn">ä¿å­˜å¼€å¿ƒ</button>
                </div>
                <div id="happy-entries" class="entries-list"></div>
            </div>
        </div>

        <!-- åæƒ…ç»ªåƒåœ¾æ¡¶ -->
        <div id="trash-page" class="page">
            <div class="entries-container">
                <h2>åæƒ…ç»ªåƒåœ¾æ¡¶</h2>
                <p>æŠŠä¸å¼€å¿ƒçš„äº‹æƒ…éƒ½ä¸¢è¿›æ¥å§</p>
                <div class="trash-input">
                    <textarea id="unhappy-text" class="entry-textarea trash-textarea" placeholder="æœ‰ä»€ä¹ˆä¸å¼€å¿ƒçš„äº‹ï¼Œè¯´å‡ºæ¥ä¼šå¥½å—äº›"></textarea>
                    <button id="save-trash" class="save-btn trash-btn">ä¸¢å¼ƒæƒ…ç»ª</button>
                </div>
                <div id="unhappy-entries" class="entries-list"></div>
            </div>
        </div>
    </div>

    <!-- éŸ³é¢‘ -->
    <audio id="music"><source src="æˆ‘ä»¬.mp3" type="audio/mpeg">æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚</audio>

    <!-- çƒŸèŠ±æŒ‰é’® & å®¹å™¨ -->
    <button id="fireworksBtn"><i class="fas fa-fire"></i> ç‚¹ç‡ƒçˆ±çš„çƒŸèŠ±</button>
    <div id="fireworks-container"></div>
    <div id="qixi-text">ä¸ƒå¤•å¿«ä¹</div>

    <script>
        /* ========== çˆ±å¿ƒèƒŒæ™¯ ========== */
        function createHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = 'â¤ï¸';
            heart.classList.add('heart');
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (Math.random() * 3 + 5) + 's';
            heart.style.fontSize = (Math.random() * 15 + 10) + 'px';
            heart.style.opacity = Math.random() * 0.5 + 0.3;
            heart.style.transform = `rotate(${Math.random() * 20 - 10}deg)`;
            document.getElementById('hearts').appendChild(heart);
            setTimeout(() => heart.remove(), 8000);
        }
        for (let i = 0; i < 20; i++) setTimeout(() => createHeart(), i * 200);
        setInterval(createHeart, 300);

        /* ========== çˆ±æƒ…è®¡æ—¶å™¨ ========== */
       /* ========== çˆ±æƒ…è®¡æ—¶å™¨ ä¸ å€’è®¡æ—¶ ========== */
(function(){
    const START_LOVE = new Date('2023-07-15T00:00:00');
    const START_328  = new Date('2023-03-28T00:00:00');
    const MS_DAY = 24*3600*1000;

    const $ = id => document.getElementById(id);

    /* 1. ä¸»è®¡æ—¶å™¨ï¼šå¹´/æœˆ/æ—¥/æ—¶/åˆ†/ç§’ */
    function updateLoveTimer(){
        const now = new Date();
        const diff = now - START_LOVE;

        const seconds = Math.floor(diff/1000)%60;
        const minutes = Math.floor(diff/(1000*60))%60;
        const hours   = Math.floor(diff/(1000*60*60))%24;
        const days    = Math.floor(diff/MS_DAY);

        const years = Math.floor(days/365);
        const rem   = days % 365;
        const months = Math.floor(rem/30);
        const finalDays = rem % 30;

        $('years'  ).textContent = years;
        $('months' ).textContent = months;
        $('days'   ).textContent = finalDays;
        $('hours'  ).textContent = hours.toString().padStart(2,'0');
        $('minutes').textContent = minutes.toString().padStart(2,'0');
        $('seconds').textContent = seconds.toString().padStart(2,'0');

        /* 2. æ•´ç™¾å¤©å€’è®¡æ—¶ */
        const nextHundred = Math.ceil((days+1)/100)*100;
        const leftHundred = nextHundred - days;
        $('hundredDay').textContent =
            leftHundred===0
            ? `ğŸ‰ ä»Šå¤©æ˜¯ç¬¬ ${nextHundred} å¤©ï¼`
            : `è·ç¦»ç¬¬ ${nextHundred} å¤©è¿˜æœ‰ ${leftHundred} å¤©`;

        /* 3. å‘¨å¹´å€’è®¡æ—¶ */
        const yearsPassed = Math.floor(days/365);
        const nextYearDay = (yearsPassed+1)*365;
        const leftYearDay = nextYearDay - days;
        $('yearDay').textContent =
            leftYearDay===0
            ? `ğŸ‚ ä»Šå¤©æ˜¯æˆ‘ä»¬ ${yearsPassed+1} å‘¨å¹´ï¼`
            : `è·ç¦» ${yearsPassed+1} å‘¨å¹´è¿˜æœ‰ ${leftYearDay} å¤©`;

        /* 4. 3Â·28 èŠ‚æ—¥å€’è®¡æ—¶ï¼ˆä»…å€’è®¡æ—¶ï¼Œä¸æ˜¾ç¤ºå·²è¿‡å‡ å¹´ï¼‰ */
        const thisYear328 = new Date(now.getFullYear(), 2, 28); // 2 = 3æœˆ
        const next328 = now < thisYear328 ? thisYear328 : new Date(now.getFullYear()+1, 2, 28);
        const left328 = next328 - now;
        const d = Math.floor(left328/MS_DAY);
        const h = Math.floor(left328/3600000)%24;
        const m = Math.floor(left328/60000)%60;
        const s = Math.floor(left328/1000)%60;
        $('day328').textContent =
            left328===0
            ? 'ğŸŒ¸ ä»Šå¤©æ˜¯ 3Â·28 èŠ‚æ—¥ï¼'
            : `è·ç¦» 3Â·28 èŠ‚æ—¥è¿˜æœ‰ ${d} å¤© ${h} æ—¶ ${m} åˆ† ${s} ç§’`;
    }

    updateLoveTimer();
    setInterval(updateLoveTimer,1000);
})();

        /* ========== éŸ³ä¹æ’­æ”¾å™¨ ========== */
        const music = document.getElementById('music');
        const playBtn = document.getElementById('playBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progress = document.getElementById('progress');
        const currentTimeEl = document.getElementById('currentTime');
        const volumeSlider = document.getElementById('volumeSlider');

        music.volume = 0.7;
        volumeSlider.value = 0.7;

        playBtn.addEventListener('click', () => {
            if (music.paused) {
                music.play();
                playBtn.innerHTML = '<i class="fas fa-pause"></i>';
            } else {
                music.pause();
                playBtn.innerHTML = '<i class="fas fa-play"></i>';
            }
        });
        music.addEventListener('timeupdate', () => {
            const percent = (music.currentTime / music.duration) * 100;
            progress.style.width = `${percent}%`;
            const m = Math.floor(music.currentTime / 60);
            const s = Math.floor(music.currentTime % 60);
            currentTimeEl.textContent = `${m}:${s < 10 ? '0' : ''}${s}`;
        });
        progressContainer.addEventListener('click', e => {
            const width = progressContainer.clientWidth;
            const clickX = e.offsetX;
            music.currentTime = (clickX / width) * music.duration;
        });
        volumeSlider.addEventListener('input', () => music.volume = volumeSlider.value);

        /* ========== é¡µé¢å¯¼èˆª ========== */
        const navItems = document.querySelectorAll('.nav-item');
        const pages = document.querySelectorAll('.page');

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const pageId = item.getAttribute('data-page');
                navItems.forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');
                pages.forEach(page => page.classList.remove('active'));
                document.getElementById(`${pageId}-page`).classList.add('active');

                // åˆ‡æ¢é¡µé¢æ—¶é‡æ–°æ‹‰å–äº‘ç«¯æ•°æ®
                if (pageId === 'happy' || pageId === 'trash') loadEntries(pageId);
            });
        });

        /* ========== Supabase é…ç½® ========== */
        const supabaseUrl  = 'https://pqqfvciynvneypzbfqkk.supabase.co';
        const supabaseKey  = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBxcWZ2Y2l5bnZuZXlwemJmcWtrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwMjExOTgsImV4cCI6MjA3MTU5NzE5OH0.C04g1knnbLB3desOWhjlxWZ2O5srr7BmDE38P5Ugc3o';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        /* ========== äº‘ç«¯å­˜å‚¨åŠŸèƒ½ ========== */
        const saveEntry = async (type, text) => {
            try {
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const userIp = ipData.ip;

                const tableName = type === 'happy' ? 'happy' : 'unhappy';
                const { error } = await supabaseClient
                    .from(tableName)
                    .insert([{ text, user_ip: userIp }]);

                if (error) throw error;

                document.getElementById(`${type}-text`).value = '';
                loadEntries(type);
                alert('äº‘ç«¯ä¿å­˜æˆåŠŸï¼');
            } catch (err) {
                console.error(err);
                // å¤±è´¥ â†’ å›é€€æœ¬åœ°å­˜å‚¨
                const entries = JSON.parse(localStorage.getItem(`${type}Entries`)) || [];
                entries.unshift({ text, date: new Date().toLocaleString('zh-CN') });
                localStorage.setItem(`${type}Entries`, JSON.stringify(entries));
                document.getElementById(`${type}-text`).value = '';
                loadEntries(type);
                alert('ç½‘ç»œå¼‚å¸¸ï¼Œå·²ä¿å­˜åˆ°æœ¬åœ°');
            }
        };

        const loadEntries = async (type) => {
            const container = document.getElementById(`${type}-entries`);
            try {
                const tableName = type === 'happy' ? 'happy' : 'unhappy';
                const { data, error } = await supabaseClient
                    .from(tableName)
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                container.innerHTML = data.map(entry => `
                    <div class="entry-item ${type === 'unhappy' ? 'trash-item' : ''}">
                        <div class="entry-date">${new Date(entry.created_at).toLocaleString('zh-CN')}</div>
                        <div>${entry.text}</div>
                        <div class="entry-meta">æ¥è‡ª ${entry.user_ip}</div>
                    </div>`).join('');
            } catch {
                // è¯»å–äº‘ç«¯å¤±è´¥ â†’ æœ¬åœ°
                const entries = JSON.parse(localStorage.getItem(`${type}Entries`)) || [];
                container.innerHTML = entries.map(e => `
                    <div class="entry-item ${type === 'unhappy' ? 'trash-item' : ''}">
                        <div class="entry-date">${e.date}</div>
                        <div>${e.text}</div>
                        <div class="entry-meta">ï¼ˆæœ¬åœ°ï¼‰</div>
                    </div>`).join('');
            }
        };

        document.getElementById('save-happy').addEventListener('click', () => {
            const val = document.getElementById('happy-text').value.trim();
            if (val) saveEntry('happy', val);
        });
        document.getElementById('save-trash').addEventListener('click', () => {
            const val = document.getElementById('unhappy-text').value.trim();
            if (val) saveEntry('unhappy', val);
        });

        /* ========== çƒŸèŠ±ç‰¹æ•ˆ ========== */
        const fireworksBtn = document.getElementById('fireworksBtn');
        const fireworksContainer = document.getElementById('fireworks-container');
        const qixiText = document.getElementById('qixi-text');
        const colors = ['#6e8efb', '#4a6cf7', '#a777e3', '#8a5ce6', '#ffd700', '#ffc107', '#ff8c00', '#ff6b00'];
        let fireworks = [], animationId = null;

        class Firework {
            constructor() {
                this.x = Math.random() * innerWidth;
                this.y = innerHeight + 20;
                this.targetY = 100 + Math.random() * (innerHeight / 2);
                this.speed = 2 + Math.random() * 3;
                this.size = 2 + Math.random() * 3;
                this.color = colors[Math.floor(Math.random() * colors.length)];
                this.hasExploded = false;
                this.particles = [];
                this.element = document.createElement('div');
                this.element.style.cssText = `position:absolute;width:${this.size}px;height:${this.size}px;border-radius:50%;background:${this.color};left:${this.x}px;top:${this.y}px;box-shadow:0 0 5px ${this.color},0 0 10px ${this.color}`;
                fireworksContainer.appendChild(this.element);
            }
            update() {
                if (!this.hasExploded) {
                    this.y -= this.speed;
                    this.element.style.top = this.y + 'px';
                    if (this.y <= this.targetY) this.explode();
                } else {
                    for (let i = this.particles.length - 1; i >= 0; i--) {
                        this.particles[i].update();
                        if (this.particles[i].alpha <= 0) {
                            this.particles[i].element.remove();
                            this.particles.splice(i, 1);
                        }
                    }
                    if (this.particles.length === 0) {
                        this.element.remove();
                        return true;
                    }
                }
                return false;
            }
            explode() {
                this.hasExploded = true;
                this.element.remove();
                for (let i = 0; i < 60 + Math.floor(Math.random() * 40); i++) {
                    this.particles.push(new Particle(this.x, this.y, this.color));
                }
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x; this.y = y; this.color = color;
                this.angle = Math.random() * Math.PI * 2;
                this.speed = 0.5 + Math.random() * 3;
                this.friction = 0.95;
                this.gravity = 0.2;
                this.alpha = 1;
                this.size = 1 + Math.random() * 2;
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.element = document.createElement('div');
                this.element.style.cssText = `position:absolute;width:${this.size}px;height:${this.size}px;border-radius:50%;background:${this.color};left:${this.x}px;top:${this.y}px;box-shadow:0 0 5px ${this.color},0 0 10px ${this.color}`;
                fireworksContainer.appendChild(this.element);
            }
            update() {
                this.vx *= this.friction;
                this.vy *= this.friction;
                this.vy += this.gravity;
                this.x += this.vx;
                this.y += this.vy;
                this.alpha -= 0.01;
                this.element.style.left = this.x + 'px';
                this.element.style.top = this.y + 'px';
                this.element.style.opacity = this.alpha;
            }
        }

        function animateFireworks() {
            animationId = requestAnimationFrame(animateFireworks);
            if (Math.random() < 0.05 && fireworks.length < 15) fireworks.push(new Firework());
            for (let i = fireworks.length - 1; i >= 0; i--) {
                if (fireworks[i].update()) fireworks.splice(i, 1);
            }
        }

        fireworksBtn.addEventListener('click', () => {
            fireworksContainer.style.display = 'block';
            fireworksContainer.innerHTML = '';
            fireworks = [];
            qixiText.style.opacity = '1';
            qixiText.style.transform = 'translate(-50%, -50%) scale(1)';
            if (animationId) cancelAnimationFrame(animationId);
            animateFireworks();
            setTimeout(() => {
                cancelAnimationFrame(animationId);
                animationId = null;
                qixiText.style.opacity = '0';
                qixiText.style.transform = 'translate(-50%, -50%) scale(0)';
                setTimeout(() => fireworksContainer.style.display = 'none', 2000);
            }, 15000);
        });

        /* ========== åˆå§‹åŠ è½½æ•°æ® ========== */
        loadEntries('happy');
        loadEntries('unhappy');
    </script>
</body>
</html>
